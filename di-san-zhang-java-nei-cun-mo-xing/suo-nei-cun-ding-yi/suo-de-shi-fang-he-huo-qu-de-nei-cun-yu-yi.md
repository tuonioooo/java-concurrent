锁的释放和获取的内存语义

当线程释放锁时，JMM会把该线程对应的本地内存中的共享变量刷新到主内存中。以上面的MonitorExample程序为例，A线程释放锁后，共享数据的状态示意图如图3-5-2-1所示。

图3-5-2-1![](/assets/import-3-5-2-1.png)

当线程获取锁时，JMM会把该线程对应的本地内存置为无效。从而使得被监视器保护的

临界区代码必须从主内存中读取共享变量。图3-5-2-2是锁获取的状态示意图。

图3-5-2-2

![](/assets/import-3-5-2-2.png)



